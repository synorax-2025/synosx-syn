/* =============================
   SX ORB — Global Floating Entry (v1)
   - Reusable across all pages
   - Brand symbol (not text)
   - Mobile primary system entry
   ============================= */

/* default hidden on desktop */
.sx-orb { display: none; }

/* -----------------------------
   Animations (v1)
   ----------------------------- */

/* Open pulse: one-time on each menu open */
@keyframes sxOrbPulse {
  0%   { transform: scale(1);    filter: brightness(1) saturate(1); }
  35%  { transform: scale(1.08); filter: brightness(1.35) saturate(1.3); }
  70%  { transform: scale(1.03); filter: brightness(1.12) saturate(1.12); }
  100% { transform: scale(1);    filter: brightness(1) saturate(1); }
}

/* Slow breathe: only while menu is open (subtle) */
@keyframes sxOrbBreathe {
  0%   { transform: scale(1);    filter: brightness(1.06) saturate(1.05); }
  50%  { transform: scale(1.02); filter: brightness(1.16) saturate(1.12); }
  100% { transform: scale(1);    filter: brightness(1.06) saturate(1.05); }
}

@media (max-width: 767.98px) {
  .sx-orb{
    position: fixed;
    right: 16px;
    bottom: calc(60px + var(--sx-safe-bottom));

    /* ✅ Must be above overlay(120) and panel(130) to remain visible */
    z-index: 140;

    width: 54px;
    height: 54px;
    border-radius: 999px;
    border: 1px solid rgba(148,163,184,0.35);
    background: rgba(8,12,24,0.35);

    padding: 0;
    cursor: pointer;
    -webkit-tap-highlight-color: transparent;

    box-shadow:
      0 22px 46px rgba(0,0,0,0.52),
      inset 0 0 0 1px rgba(255,255,255,0.06);

    display: grid;
    place-items: center;

    backdrop-filter: blur(10px);
    transition:
      transform 160ms var(--ease),
      box-shadow 160ms var(--ease),
      border-color 200ms var(--ease);
  }

  .sx-orb:active{
    transform: scale(0.95);
    box-shadow:
      0 16px 32px rgba(0,0,0,0.58),
      inset 0 0 0 1px rgba(255,255,255,0.08);
  }

  .sx-orb:focus-visible{
    outline: none;
    box-shadow:
      0 0 0 2px var(--focus),
      0 22px 46px rgba(0,0,0,0.52),
      inset 0 0 0 1px rgba(255,255,255,0.06);
  }

  /* Orb core: the “sphere” itself */
  .sx-orb-core{
    width: 40px;
    height: 40px;
    border-radius: 999px;
    position: relative;

    background:
      radial-gradient(circle at 30% 28%, rgba(255,255,255,0.35), rgba(255,255,255,0) 38%),
      radial-gradient(circle at 70% 78%, rgba(99,102,241,0.55), rgba(99,102,241,0) 52%),
      radial-gradient(circle at 40% 70%, rgba(59,130,246,0.60), rgba(59,130,246,0) 56%),
      radial-gradient(circle at 50% 55%, rgba(12,18,40,0.95), rgba(8,10,20,0.98));

    box-shadow:
      0 10px 24px rgba(59,130,246,0.18),
      0 10px 24px rgba(99,102,241,0.14),
      inset 0 0 0 1px rgba(255,255,255,0.10);

    /* default idle */
    transform: scale(1);
    filter: none;
    transition: filter 200ms var(--ease);
  }

  /* subtle aura ring */
  .sx-orb-core::after{
    content:"";
    position: absolute;
    inset: -8px;
    border-radius: 999px;
    background:
      radial-gradient(circle at 50% 50%,
        rgba(59,130,246,0.18),
        rgba(99,102,241,0.10),
        rgba(0,0,0,0) 62%
      );
    filter: blur(3px);
    opacity: 0.55; /* idle lower */
    pointer-events: none;
    transition: opacity 220ms var(--ease);
  }

  /* -----------------------------
     Menu Open State (Active)
     Driven by: html.sx-menu-open (sx.menu.js)
     ----------------------------- */

  html.sx-menu-open .sx-orb{
    pointer-events: none; /* ✅ do not steal overlay clicks */
    border-color: rgba(59,130,246,0.55);
    box-shadow:
      0 22px 46px rgba(0,0,0,0.52),
      0 0 0 1px rgba(59,130,246,0.18),
      0 0 34px rgba(59,130,246,0.16),
      inset 0 0 0 1px rgba(255,255,255,0.08);
  }

  /* Make aura visibly stronger when menu is open */
  html.sx-menu-open .sx-orb-core::after{
    opacity: 0.95;
  }

  /* 1) One-time pulse on open (class toggle triggers animation restart)
     - We rely on sx.orb.js adding .sx-orb-pulse to sx-orb-core
     - If you don't use sx.orb.js, the slow breathe still shows active life
  */
  .sx-orb-core.sx-orb-pulse{
    animation: sxOrbPulse 520ms var(--ease) 1;
  }

  /* 2) Slow breathe while menu is open (always visible even without JS) */
  html.sx-menu-open .sx-orb-core{
    animation: sxOrbBreathe 2600ms var(--ease) infinite;
  }

  /* If pulse exists, pulse wins first, then breathe continues */
  html.sx-menu-open .sx-orb-core.sx-orb-pulse{
    animation:
      sxOrbPulse 520ms var(--ease) 1,
      sxOrbBreathe 2600ms var(--ease) 520ms infinite;
  }
}
.sx-orb-core.sx-orb-pulse{
  animation: sxOrbPulse 520ms var(--ease) 1;
  box-shadow:
    0 0 0 1px rgba(59,130,246,0.35),
    0 0 26px rgba(99,102,241,0.35);
}
