/* sx.statusbar.css — SynOSX System Status Bar (shared)
   ✅ Constitution-grade stable on iOS Safari / WeChat WebView
   ✅ Safe-area via padding, lift via transform, bottom always 0
*/

:root{
  /* -----------------------------
     Layout Constitution (shared)
     ----------------------------- */

  /* ✅ 跟随全站 --max（若页面未定义则回退 1200px） */
  --sb-max: var(--max, 1200px);

  /* statusbar 视觉高度（页面让位的唯一真源） */
  --sx-statusbar-h: 66px;

  /* iOS / 系统安全区（制度外变量） */
  --sx-safe-bottom: env(safe-area-inset-bottom, 0px);

  /* ✅ 抬高量：避免贴住 Home Indicator / 手势区 */
  --sx-statusbar-lift: 0px;

  /* 移动端：statusbar 单个 pill 最大宽度（配合省略号） */
  --sb-max-pill: 44vw;

  /* 对比度治理（变量级：阅读下限） */
  --fg-strong: rgba(255,255,255,0.92);
  --fg: rgba(232,236,245,0.86);
  --fg-muted: rgba(147,160,189,0.92);

  /* 颜色（允许页面覆盖） */
  --sb-border: rgba(59,130,246,0.22);
  --sb-bg: rgba(0,0,0,0.70);

  /* 兼容：如果页面没定义 mono，就给默认 */
  --mono: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono",
          "Courier New", monospace;
}

/* ✅ 页面为 statusbar 统一让位（唯一真源） */
body{
  padding-bottom: calc(
    var(--sx-statusbar-h) + var(--sx-safe-bottom) + var(--sx-statusbar-lift)
  );
}

/* -------------------------------------------------
   Statusbar (constitution-grade stable positioning)
   - bottom: 0 (never calc/env)
   - safe-area: padding-bottom
   - lift: transform
   ------------------------------------------------- */
.statusbar{
  position: fixed;
  left: 0;
  right: 0;
  bottom: 0;

  /* ✅ safe-area 不参与 bottom 计算 */
  padding-bottom: var(--sx-safe-bottom);

  /* ✅ lift 不参与布局计算（iOS/WeChat 更稳定） */
  transform: translateY(calc(-1 * var(--sx-statusbar-lift)));

  z-index: 9999;
  background: var(--sb-bg);
  border-top: 1px solid var(--sb-border);
  backdrop-filter: blur(14px);

  /* ✅ 防止被某些布局影响裁剪 */
  pointer-events: auto;
}

/* ✅ 关键：整条可横向滚动（证据不换行） + 手势治理 */
.statusbar-inner{
  max-width: var(--sb-max);
  margin: 0 auto;

  /* ✅ 这里不要再加 safe-area；safe-area 已由 .statusbar padding 承担 */
  padding: 10px 14px;

  display:flex;
  align-items:center;
  justify-content: space-between;
  gap: 12px;

  font-family: var(--mono);
  font-size: 11.5px;
  color: var(--fg);

  overflow-x: auto;
  overflow-y: hidden;
  -webkit-overflow-scrolling: touch;
  white-space: nowrap;
  scrollbar-width: none;

  /* ✅ 手势治理：减少 iOS 抢滑 */
  touch-action: pan-x;
  overscroll-behavior: contain;
}
.statusbar-inner::-webkit-scrollbar{ display:none; }

.sb-left, .sb-right{
  display:flex;
  gap: 10px;
  align-items:center;
  flex-wrap: nowrap;
  white-space: nowrap;
}

.sb-pill{
  display:inline-flex;
  align-items:center;
  gap: 8px;
  padding: 6px 10px;
  border-radius: 999px;
  border: 1px solid rgba(255,255,255,0.10);
  background: rgba(255,255,255,0.04);
  white-space: nowrap;

  flex: 0 0 auto;

  max-width: var(--sb-max-pill);
  overflow: hidden;
}

.sb-key{
  color: rgba(159,195,255,0.9);
  font-weight: 800;
  flex: 0 0 auto;
}

.sb-val{
  color: var(--fg-strong);
  flex: 1 1 auto;
  min-width: 0;
  overflow: hidden;
  text-overflow: ellipsis;
}

.sb-muted{
  color: var(--fg-muted);
  opacity: 0.85;
}

/* 可点击 pill */
.sb-copy{
  cursor:pointer;
  user-select:none;
  border-color: rgba(59,130,246,0.24);
  background: rgba(59,130,246,0.08);
  transition: 0.2s ease;
}
.sb-copy:hover{
  transform: translateY(-1px);
  border-color: rgba(59,130,246,0.40);
  background: rgba(59,130,246,0.12);
}

/* 链接（Policy） */
.sb-link{
  color: rgba(159,195,255,0.95);
  text-decoration: underline;
  text-underline-offset: 2px;
}

/* 引擎灯（默认：UNVERIFIED） */
.engine-dot{
  width: 10px;
  height: 10px;
  border-radius: 999px;
  background: rgba(239,68,68,0.95);
  box-shadow: 0 0 14px rgba(239,68,68,0.40);
  border: 1px solid rgba(255,255,255,0.12);
  flex: 0 0 auto;
}
.engine-dot.verified{
  background: rgba(74,222,128,0.95);
  box-shadow: 0 0 14px rgba(74,222,128,0.45);
}
.engine-dot.blocked{
  background: rgba(250,204,21,0.95);
  box-shadow: 0 0 14px rgba(250,204,21,0.40);
}
.engine-dot.unverified{
  background: rgba(239,68,68,0.95);
  box-shadow: 0 0 14px rgba(239,68,68,0.40);
}

/* ✅ 小屏扩大 pill 宽度上限 */
@media (max-width: 980px){
  :root{ --sb-max-pill: 62vw; }
}

/* -------------------------------------------------
   Optional hardening:
   If some page applies transform/filter to <body>/<main>,
   iOS may treat fixed as "relative fixed" and clip it.
   Turn this on ONLY if you still see missing bar.
   ------------------------------------------------- */
/*
html, body{
  transform: none !important;
  filter: none !important;
}
*/
